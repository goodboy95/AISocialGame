这是一个针对“谁是卧底”玩法的**单房间完整设计方案**。此文档聚焦于**前台用户体验、界面布局与交互流程**，旨在为开发团队提供清晰的页面构建指南。

---

# 《谁是卧底》游戏房间设计方案 (PRD)

## 1. 设计概述
本模块旨在提供一个**轻量级、响应式、即开即玩**的多人在线文字/语音社交游戏环境。核心设计目标是降低理解门槛，让“描述-投票-淘汰”这一循环过程流畅且具有视觉反馈感。

**核心体验流：**
配置房间 $\rightarrow$ 等待/补位 $\rightarrow$ 查看底牌 $\rightarrow$ 轮流描述 $\rightarrow$ 投票处决 $\rightarrow$ 胜负结算

---

## 2. 房间创建页设计 (Room Creation)

此页面通常以“模态框 (Modal)”或“独立表单页”形式存在。

### 2.1 基础配置
* **房间名称：** 默认生成（如“欢乐卧底房#8821”），支持修改。
* **人数设置：** 下拉选择 `4人` ~ `10人`（默认 6人）。
* **卧底数量：**
    * 自动模式（推荐）：系统根据总人数自动计算（4-6人1卧底，7-10人2卧底）。
    * 手动模式：允许房主微调（如 6人2卧底的困难模式）。
* **白板设置：** 开关（开启后，游戏中将出现一名没有词语的“白板”玩家）。

### 2.2 词库与节奏
* **词库类型：** 下拉选择（生活常识、成语、二次元、硬核科技、**自定义词库**）。
* **发言时长：** `30秒` / `60秒` / `90秒` / `不限时`。
* **投票时长：** 固定 `30秒`。

### 2.3 底部操作
* **显示消耗：** 如需消耗房卡/积分，在此处提示。
* **按钮：** [取消] / [创建房间]

---

## 3. 房间内布局设计 (In-Game UI)

采用 **“中心舞台 + 环绕座位”** 的布局逻辑。

### 3.1 移动端 (竖屏 H5)
* **Top Bar：** 房间号 | 轮次显示 (Round 1) | 设置(退出/音效)。
* **上部 (30%)：** **游戏信息区**。
    * 显示倒计时大数字。
    * 当前阶段提示（如：“玩家 3 正在描述...”）。
* **中部 (40%)：** **座位网格 (Grid)**。
    * 3列或4列布局，显示所有玩家头像。
* **下部 (30%)：** **操作与交互区**。
    * **Tab 1 (默认)：** 聊天记录/系统日志流。
    * **Tab 2 (功能)：** “查看我的词语”按钮（防窥设计）。
    * **Bottom Bar：** 输入框 / 按住说话 / 投票确认按钮（视阶段动态变化）。

### 3.2 桌面端 (横屏 Web)
* **左侧 (25%)：** **信息面板**。
    * 玩家列表（竖排，显示详细状态：准备、掉线、积分）。
    * 房间规则简述。
* **中部 (50%)：** **拟物圆桌 (Round Table)**。
    * 玩家头像呈圆形分布在屏幕中央。
    * 中央显示当前的倒计时和阶段大字。
* **右侧 (25%)：** **聊天与日志**。
    * 上部分：系统公告（谁投了谁）。
    * 下部分：玩家文字聊天区。
    * 底部：输入框与操作按钮组。

### 3.3 玩家卡片状态 (Player Card)
每个座位的玩家组件需包含：
* **头像：** 核心视觉元素。
* **编号：** 角标 (1-10)。
* **昵称：** 截断显示。
* **状态标记：**
    * *准备中：* 绿色勾。
    * *发言中：* 呼吸灯光圈 / 声波动效。
    * *已死亡：* 头像置灰 / 打叉 / 墓碑图标。
    * *托管/掉线：* 红色断链图标。

---

## 4. 完整游戏流程功能拆解

### 阶段一：等待大厅 (Lobby Phase)
* **房主功能：**
    * **邀请：** 复制链接/二维码。
    * **添加电脑：** 点击空位，选择“填入电脑玩家”（用于快速补位）。
    * **踢人：** 点击玩家头像 -> 移出房间。
    * **开始游戏：** 仅当所有玩家（含电脑）都“准备”时高亮。
* **普通玩家功能：**
    * **换座：** 点击空位可切换位置。
    * **准备/取消准备：** 只有准备后才能开局。

### 阶段二：发牌与查词 (Distribution)
* **动效：** 所有玩家卡片翻转或发牌动画。
* **交互 - 查看词语：**
    * 屏幕中央弹出 **“点击查看你的词语”** 遮罩。
    * 用户长按或点击后，显示词语（例如“可口可乐”）和身份提示（“请描述，不要暴露”）。
    * **防窥模式：** 只有按住才显示，松开立即打码，防止线下聚会时被旁边人看到。

### 阶段三：轮流描述 (Description Phase)
* **顺序逻辑：** 系统自动高亮当前序号的玩家（如 1号）。
* **当前玩家视角：**
    * 输入框激活（允许打字） 或 麦克风激活（允许语音）。
    * 显示“倒计时 30s”。
    * 提供“结束发言”按钮（点击后提前结束倒计时）。
* **其他玩家视角：**
    * 输入框禁用（禁止插话，防爆词）。
    * 看到当前玩家头像有“发言中”动效。
    * 实时显示转换的文字（如果是语音）或气泡（如果是文字）。

### 阶段四：投票环节 (Voting Phase)
* **界面变化：**
    * 所有**存活**玩家头像开始跳动或高亮，变为**可点击状态**。
    * 屏幕下方提示：“请找出卧底”。
* **交互：**
    * 点击某玩家头像 -> 选中态（加边框）。
    * 点击“确认投票”按钮提交。
    * 支持“弃票”选项。
* **实时反馈（可选配置）：**
    * 方案A（暗票）：不显示谁投了谁，只显示“已投票”标记。
    * 方案B（明票）：头像旁实时显示票数 +1。
    * *建议默认采用暗票，增加悬念。*

### 阶段五：处决与遗言 (Elimination)
* **票型公布：**
    * 弹窗展示投票结果列表（如：1号投3号，2号投3号... 3号出局）。
* **处决动画：**
    * 被票出的玩家头像变灰/破碎。
* **身份揭示：**
    * 系统公告：“3号玩家出局，他的身份是 [卧底/平民/白板]”。
    * 若为[平民]，游戏继续；若满足胜利条件，游戏结束。
* **遗言（可选）：** 给予被淘汰玩家 30秒 时间发表最后感言。

### 阶段六：胜负结算 (Settlement)
* **胜利动画：** “平民胜利”或“卧底胜利”的大字特效。
* **复盘表格：**
    * 列出所有玩家的：昵称、身份、持有的词语。
    * 标出谁是卧底，谁是白板。
* **MVP/称号：** 系统根据存活轮数或投票准确率，颁发简单勋章（如“神探”、“伪装者”）。
* **后续操作：** [再来一局]（回到大厅状态）、[退出房间]。

---

## 5. 异常处理与边缘情况

1.  **断线重连 (Reconnect)：**
    * 玩家刷新页面或网络恢复后，重新进入房间，需**自动同步**当前游戏进度（如正在第2轮发言中），并恢复之前的词语查看功能。
2.  **超时处理 (Timeout)：**
    * 发言阶段超时：系统自动发送系统消息“该玩家沉默了”，并切换下一位。
    * 投票阶段超时：视为“弃票”。
3.  **平票 (Draw)：**
    * 当最高票数有多人相同（如 3号2票，5号2票），进入**PK模式**。
    * 系统只允许平票玩家再次发言，且其他玩家只能在这几人中投票。

---

## 6. 前端技术实现建议 (For Developers)

* **状态管理：** 使用 Redux/Vuex/Zustand 管理 `currentPhase` (当前阶段) 和 `playerList` (玩家状态)。
* **WebSocket 消息体示例：**
    * `GAME_START`: 包含 `myWord`。
    * `TURN_CHANGE`: 包含 `currentSeatIndex`, `endTime`。
    * `VOTE_RESULT`: 包含 `eliminatedSeat`, `voteDetails` (谁投了谁)。
* **音频处理：** 无论用户输入语音还是文字，建议在前端均转为“文字气泡”展示在历史记录中，方便回顾（语音可保留播放按钮）。

该方案聚焦于构建一个**标准、中立的联机游戏容器**，任何玩家（无论是真人还是未来接入的AI）在系统中均被视为标准的 `Player` 对象，仅在输入源上有所区别。